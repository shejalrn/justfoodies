<!DOCTYPE html>
<html>
<head>
    <title>Test Razorpay</title>
</head>
<body>
    <h1>Test Razorpay Payment</h1>
    <button onclick="testPayment()">Test Payment Creation</button>
    <button onclick="testRazorpay()">Test Razorpay Gateway</button>
    
    <div id="result"></div>
    
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script>
        async function testPayment() {
            try {
                const response = await fetch('/api/orders/create-payment', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ amount: 100, orderNumber: 'TEST123' })
                });
                const data = await response.json();
                document.getElementById('result').innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            } catch (error) {
                document.getElementById('result').innerHTML = 'Error: ' + error.message;
            }
        }
        
        async function testRazorpay() {
            try {
                if (!window.Razorpay) throw new Error('Razorpay not loaded');
                
                const response = await fetch('/api/orders/create-payment', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ amount: 100, orderNumber: 'TEST123' })
                });
                const data = await response.json();
                
                const rzp = new Razorpay({
                    key: data.key,
                    amount: data.amount,
                    currency: data.currency,
                    name: 'JustFoodies Test',
                    order_id: data.id,
                    handler: (response) => alert('Payment successful!'),
                    modal: { ondismiss: () => alert('Payment cancelled') }
                });
                rzp.open();
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }
    </script>
</body>
</html>